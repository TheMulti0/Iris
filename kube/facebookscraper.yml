apiVersion: v1
kind: Secret
metadata:
  name: facebooksecrets
type: Opaque
stringData:
  connectionstring: mongodb://FacebookScraperDb123:FacebookScraperDb123456@mongodb:27017/FacebookScraperDb
  databasename: FacebookScraperDb
  pagecount: "3"
  sentry: https://c71868cd86dd4ba8ae64dc1513b0497c@o194751.ingest.sentry.io/5429640
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: facebookscraper-config
data:
  cookies.txt: "# Netscape HTTP Cookie File
# http://curl.haxx.se/rfc/cookie_spec.html
# This file was generated by EditThisCookie
.facebook.com	TRUE	/	FALSE	1625383898	_fbp	fb.1.1612198421519.447483472
.facebook.com	TRUE	/	TRUE	1635409120	c_user	100028129958920
.facebook.com	TRUE	/	TRUE	1631299748	datr	5s0LYA0VG2fKPPq16vtx-qIa
.facebook.com	TRUE	/	TRUE	1620461998	dpr	2.3333334922790527
.facebook.com	TRUE	/	TRUE	1627633118	fr	193gY1GS6h7T8SS22.AWVVj1yszZ9_GGKmfyQsmJUfxho.BgjQ7e.R9.AAA.0.0.BgjQ7e.AWU5klmg67s
.facebook.com	TRUE	/	TRUE	1634671392	sb	5s0LYI0S24C1MEk1GGo4lHAJ
.facebook.com	TRUE	/	TRUE	1619947085	spin	r.1003721168_b.trunk_t.1619857083_s.1_v.2_
.facebook.com	TRUE	/	TRUE	1620279454	wd	2421x1219
.facebook.com	TRUE	/	TRUE	1635409120	xs	2%3AtV6fTZmXfCQvOg%3A2%3A1619119389%3A15141%3A11559%3A%3AAcXWWFzgjpZ7XkVjHf-EOmkREFwlPlxXGesxPTnuVKU"
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: facebookscraper
  name: facebookscraper
spec:
  replicas: 1
  selector:
    matchLabels:
      app: facebookscraper
  template:
    metadata:
      labels:
        app: facebookscraper
    spec:
      containers:
        - image: irisupdate/facebookscraper:latest
          imagePullPolicy: "Always"
          name: facebookscraper
          volumeMounts:
            - name: config
              mountPath: /app/cookies.txt
              subPath: cookies.txt
          env:
            - name: RabbitMqConnection__ConnectionString
              valueFrom:
                secretKeyRef:
                  name: rabbitmqsecrets
                  key: connectionstring
            - name: UpdatesScraperDb__ConnectionString
              valueFrom:
                secretKeyRef:
                  name: facebooksecrets
                  key: connectionstring
            - name: UpdatesScraperDb__DatabaseName
              valueFrom:
                secretKeyRef:
                  name: facebooksecrets
                  key: databasename
            - name: UpdatesProvider__PageCount
              valueFrom:
                secretKeyRef:
                  name: facebooksecrets
                  key: pagecount
            - name: UpdatesProvider__UserName
              valueFrom:
                secretKeyRef:
                  name: facebooksecrets
                  key: username
            - name: UpdatesProvider__Password
              valueFrom:
                secretKeyRef:
                  name: facebooksecrets
                  key: password
            - name: Sentry__Dsn
              valueFrom:
                secretKeyRef:
                  name: facebooksecrets
                  key: sentry
      restartPolicy: Always
      volumes:
        - name: config
          configMap:
            name: facebookscraper-config
